```{r Setup, include=FALSE, results="hide", warning=FALSE}
opts_chunk$set(fig.path = "figures/", dev=c("pdf", "png"), fig.pos='htbp', fig.width=5, fig.height=1.6, dpi=700, fig.show='hold', fig.lp="fig:", cache=FALSE, par=TRUE, echo=FALSE, results="hide", message=FALSE, warning=FALSE)

#library(extrafont)
#font_import(pattern="LinBiolinum")

```

# Literature review

[TODO: note the published components of this literature review]

The main aim of this thesis is to build a model which can assist planners and decision makers in improving the urban metabolism of an area, in order that the benefits of urbanisation can continue to be realised to the benefit of a growing urban global population, while reducing the environmental and economic threats they pose. With this in mind, this literature review has two main purposes: first, to identify the gaps in current research, and so to more precisely define the scope of this thesis; and second, to begin identifying methods which could be adopted in the modelling work.

The two main areas research fields addressed by this theses are urban metabolism (UM), and resource optimisation modelling (ROM). This chapter identifies the key ideas, concepts, principles and methods of these subject areas, beginning in Section [TODO:] showing how UM research has been used to better understand how cities use resources, and notes developments in UM research pertinent to this thesis. Section [TODO:] then introduces to the idea of 'modelling' in order to make the case that optimisation modelling can play a useful role in UM research, before Section [TODO:] looks in more detail at the types of models used in resource management modelling, in order to identify both the need for an integrated resource management model, and the methods by which such a model can be constructed. Once this survey of the literature has been completed, it is then possible to precisely define the scope [TODO: better word?] of this thesis, which is done by providing definitions of the words which comprise the thesis title, in Section [TODO:]. Finally, Section [TODO:] outlines [TODO: summarises?] the gaps and contributions met by this thesis.

This review first argues that the UM field should advance [TODO: foster, nuture, develop?] a more sophisticated understanding of how the resource management processes in a city affects its overall metabolism. Second, the review shows that urban resource optimisation modelling tends to only consider one resource sector in isolation (e.g. an urban energy system), and thus we argue for optimisation models which consider the simultaneous design of energy, water, and waste systems, i.e. 'integrated'. Nevertheless, there are sufficient precedent models to suggest that such a model can be both formulated, and applied. The rest of this thesis goes on to meet the first challenge by proposing that a city's management of goods and services can be modelled as an 'engineered system' (i.e., a network of processes which convert and transport resources). Notably, this understanding incorporates energy, water and waste management systems, and thus this thesis is placed to address the second challenge, by representing this engineered system using a set of equations which can form the basis of an optimisation model. In this way, this chapter lays the foundation to justify and contribute an optimisation tool which can help improve a city's metabolism.


## The past, present and future of urban metabolism research

In this section, we introduce UM generally, before more specifically tracking the extent to which the role of resource management processes -- which will be shown to be an important consideration in this thesis -- have been considered in UM research.

In 1965, the American engineer Abel Wolman introduced 'urban metabolism'. Writing in *Scientific American* he defined the metabolic requirements of a city as "all the materials and commodities needed to sustain the city's inhabitants at home, at work and at play" [@Wolman1965, p.156]. He recognised that resource consumption was necessary to sustain urban living, but was motivated to study urban metabolism because of his concerns that as cities grow, their rising material and energy inputs and outputs were causing problems with water supply, sewage disposal and air pollution. At its most basic, an urban metabolism study will quantify the material and/or energy inputs and outputs of any given area -- Wolman did this for a hypothetical city of one million inhabitants [TODO: using government data?].

Since Wolman the UM concept has given rise to more sophisticated studies which seek to understand the scale and origins of urban consumption/waste, and its relationship to an area's form, geography, and other characteristics, and so more recently @Kennedy2007 has defined UM as "the sum total of the technical and socioeconomic processes that occur in cities, resulting in growth, production of energy and elimination of waste" (p.44). UM research has become closely associated with the notion of 'sustainability' [@Brutland1987], which includes three components as part of its so-called "triple bottom line", namely to maintain economic, social and environmental performance). Consequently, the UM concept has provided tools which help planners and policy makers improve urban sustainability, and is even employed by governments to help [TODO: finish and tidy sentence] (for example, in the United Kingdom, by @Clift2015).

<!--
its basic function is to highlight how cities can sustain their developing forms and socioeconomic functions, but with less harmful resource (forms, functions and flows). @Zhang2013's review mainly focuses on the flows ("research on urban metabolism therefore focuses on the sources and consumption of resources, and on their cycling within the system plus the emission, treatment, and recycling of wastes"). 
-->


As of 2011, there have been around 20 comprehensive UM studies of cities [@Kennedy2011] [TODO: update this figure in view of Kennedy et al. PNAS paper? More recently, a number of researchers from all over the globe have ]. The field has grown such that 'urban metabolism' is fast becoming a buzzword in urban research literature, perhaps enjoying the benefits of increased data availability in conjunction with "an explosion of research on cities and on sustainability in recent years" [@NextCity2014]. @Kennedy2012a write of the "substantial momentum" (p.781) to its study and highlight its usefulness to "address concerns over the magnitudes of global resource flows" as well as the "analysis of specific policy issues" (p.780). 

Typically, the methodology to conduct a UM study begins by defining a boundary around an urban area, and then consulting data sources in order to quantify material, energy, water and other resource flows into and out of a city on a yearly basis [@Kennedy2014] (more details on methodology are presented in Section [TODO:]). In practice therefore, a suitable definition of 'urban' is required. Definitions can range from defining an urban area in administrative termsÂ¸ or in terms of population density [TODO: is there a World Bank reference for this?]. However, urban metabolism studies care about resource flows, and from this perspective there are at least three ways to define an urban boundary, suggested by @Ramaswami2011 (from the point of view of quantifying a city's greenhouse gas emissions), and adapted by @Keirstead2012b:

- *Pure geographic* defines a boundary as the city's administrative boundaries;
- *Geographic-plus* extends the pure geographic definition to include readily traceable upstream flows, such as electricity consumption;
- *Pure consumption* attributes resource flows to the urban economy which generates a demand for a good or service. For example, a service-based city will require products manufactured in an industrial-based city. On the pure consumption definition, these flows would be attributed to the service-based city. This definition therefore attempts to 'even out' disparities between cities which arise from their different functions.

This thesis will adopt the 'geographic-plus' definition, for reasons outlined in Section [TODO:].

<!--
Studies of an area's metabolism can take a number of forms, focussing on the different elements of an urban system summarized by @Ravalde2016's hierarchical representation illustrated in Figure \ref{fig:metab}. Resource demand and waste generation at the bottom drives aggregate resource exchanges between a city and the environment at the top. In the middle, are the processes which convert and transport resources. We can use this representation, along with the 'top', 'middle' and 'bottom' terminology to outline the types of UM modelling that exist.

- Some work provides **top of system understanding** in the form of **accounting** exercises to quantify a city's resource flows at the top. The results of these can be used to to compare between cities(these results can also be used to calculate carbon footprint, ecological footprint and other metrics). [TODO: as in REFERENCE]. Or they can be used to related to other variables of interest [TODO: reference: e.g. water levels in Toronto]
- Elsewhere, UM studies seek to provide **top-bottom system understanding**, by relating such resource flows (or stocks) at the top to aspects of a city, building from the bottom up.
  	- @Ye2011: deterministically relates household construction characteristics to greenhouse gas emissions.
	- @Kellet2013 builds up emissions from building, transport, human, and vegetation sources.
	- @Baynes2012a: sectoral energy demand and upstream energy consumption
- Elsewhere, UM studies seek to provide **top-city system understanding**, by relating such resource flows (or stocks) at the top to aspects of a city such as resource flows at the top to socioecnomics, geography, urban form, etc. [TODO: add reference]. These could then be used to carry out scenario analysis, strategic planning
  	- @Liang214: statistically relates a city's quantity of steel stock with levels of nightime lighting
  	- @Fischer-Kowalski2004: society size and transport volume
	- @Fung2005: relates sustainability to instituational activities
	- @Hung2005: relates energy flows to urban development
  	- @Newman1999a: (theoretically) relates resource flows to urban form and 'livability'. 
- Elsewhere, UM studies seek to provide more **top-middle system understanding**, by relating such resource flows (or stocks) at the networks of processes in the middle (e.g. ENA) [TODO: add reference]. These could then be used to inform interventions, scenario analysis, strategic planning
  	- @Zhang2010: ENA to related resource flows of a city's 17 economic sectors to each other
- **middle-bottom system understanding**
  	- @Zeng2014: simulate water flows between the processes (e.g. water reclamation) and demands in an urban system, to show how demands under changing population scenarios
	- Similarly @Liang2011 resource consumption and waste emission objectives -- [TODO: leave, for now]
- Other (e.g. theory)

In coming to an understanding of **-middle** systems, some models choose to unite all resource flows under a single measures, such as @HUang2005 who use emergy. Others 
-->


A survey of the literature shows at least four ways the UM concept contributes to understanding urban sustainability.

- *To make comparisons of resource consumption.* For example, @Krausmann2008 compare the metabolism of agrarian, developing and industrialised societies. @Kennedy2007 narrows in on eight metropolitan regions around the world, examining their metabolisms since 1965 to show general trends of increasing per capita consumption of energy, water and waste (with some exceptions, such as Toronto's energy and water use). Comparisons might also take place between sectors within a single city (such as construction or commercial services), for example to determine which sectors produce the most waste [@Browne2009].
- *To provide inputs to other types of analysis.* UM studies compile annual inventories of resource flows, which can then be coupled to other data for further analysis.  For example, by combining urban metabolic data with carbon intensity factors, a city's greenhouse gas emissions can be calculated, as in @Kennedy2009 and @Kennedy2010. The 'ecological footprint' (EF) is another quantity that has been calculated from UM data [@BFF2002]. @Zucaro2014 use UM data to calculate 'urban sustainability indicators' for Rome, including carbon emissions, acidification and emergy flows.
- *To relate consumption/output to other dependent variables.* This includes identifying particular environmental problems with urban resource consumption such as waste generation impacts [@Browne2009]; water stress and contamination [@Kennedy2007]; and the degree to which economic growth is dependent on material consumption [@Schulz2007].
- *To understand or model relationships in the urban environment.* A more novel use of UM is to "develop mathematical models of processes within the urban metabolism" [@Kennedy2011, p.1970][^process-defn] in order to examine how policies or technological interventions might change stocks and flows. For example, from knowing the quantities of some of the material and energy flows into and out of processes within the urban environment, the STAN model of @Cencic2008 can be used to calculate the values of unknown process inputs and outputs. Another use is to explore relationships between different resources, with @Kenway2013 examining the links between urban energy and water consumption. Geographical dependencies can also be studied, for example @Barles2009 reveals Paris' reliance on surrounding regions for material provisions and waste management. @Bristow2013 assesses resilience and vulnerability of a city's resources, ascertaining whether or not Toronto has sufficient energy stocks in the event of supply failure or other shocks. Finally @Liu2011a have used UM inventory data to study the interdependence of economic sectors within a city.

[^process-defn]: Note that 'process' here refers generally to operations within an urban environment, rather than resource management technologies specifically.

In summary, as the environmental problems associated with urbanisation have increased, so urban metabolism has become an important tool, providing a frameword to examine resource consumption alongside notions of urban sustainability [@NextCity2014]. Specifically, urban metabolism studies can provide insight on how to maintain the socioeconomic benefits of urbanisation while limiting environmental harm. Studying it enables planners and policy makers to take stock of an area's resource consumption and output, ascertaining its long-term trends and comparing its own metabolism with other areas. The outcomes of studies can then inform policy analysis and urban design [@Kennedy2011].

Turning now to consider the components of UM in a little more detail, analysis of a city can focus on the different parts of an urban metabolic system, each of which work together in a hierarchical framework as shown in Figure \ref{fig:metab}. At the bottom lie end consumers, namely the homes, business, industry and transport that exert demands for final energy and water consumption, as well as generating wastes. At the top are the aggregate exchanges between a city and the surrounding environment: both the import of natural resources required to meet consumer demand, and the export of a city's wastes and effluents. In the middle is a network of processes that link the top and the bottom, converting natural resources to demands, as well as treating and managing locally generated wastes. Typically, urban metabolism studies seek to quantify the overall metabolic flows at the top, and to locate the origins of these flows at their point of demand at the bottom.

This section extends published arguments that advocate giving greater attention to the middle of the system, in order to show how the mix of processes used to meet demand at the bottom will affect overall metabolic inputs and outputs at the top.

\begin{figure}
	\centering
	\begin{spacing}{1.0}
	\sffamily
	\resizebox{\columnwidth}{!}{\input{04_database/metab-hierarchy.pdf_tex}}
	\end{spacing}
	\caption{Three components to an urban metabolism system with example resource flows adapted from the hypothetical city in \cite{Wolman1965}.}
	\label{fig:metab}
\end{figure}

### "Top-down"

According to @Chrysoulakis2014, most urban metabolism studies take a top-down approach. Their aim is to quantify the impacts of an entire urban area's consumption and waste generation [@Sahely2003]. Typically studies do this using data aggregated at the city scale (i.e. it cannot be traced back to particular locations or activities) [@Chrysoulakis2014]. Several methods are described in @Sahely2003. One example is Wolman's seminal study which derived a hypothetical city's resource flows from national rates of consumption (water, food and fuel) and generation (sewage, waste and air pollutants). A more sophisticated approach might adjust these values; for example, a city's food intake could be calculated by adjusting the national average food consumption according to a city's grocery bill expenditure (as suggested in Sahely et al.). Ideally though, data would be supplied directly from appropriate organisations: water consumption data from the public or private providers; electricity consumption data from market operators; and waste data from municipal authorities. Once collected, the data can be used to analyse trends and make inter-city comparisons, to reveal how variables (such as climate, urban form, economic activity etc.) correlate with overall metabolic flows, as exemplified by @Kennedy2015's study of megacities. Top-down studies can inform policy, as seen in @Liang2011 who use government statistics in a top-down metabolism study of Suzhou, China. Their findings lead to precise proposals to achieve decarbonization, in this case focussing CO$_2$ mitigation strategies on vehicle pollution (because trends indicate that the city is on course for low-carbon development in other sectors).

### "Bottom-up"

An alternative approach is to build up a picture of a city's metabolism from the bottom up, by quantifying resource flows at small scales before aggregating them over the region of study [@Chrysoulakis2009]. For example, @Kellett2013 describe a method to quantify a neighbourhood's CO$_2$ emissions by modelling the CO$_2$ flows in the neighbourhood's buildings, transport, humans, and vegetation components. For instance, to calculate the total emissions attributable to buildings, first building types are determined from architectural features (found from fieldwork, databases, and LiDAR information), enabling researchers to know the number of each building type of building in the neighbourhood; next the emissions for each type of building (such as an apartment) are estimated using a model which takes into account a building's occupancy, age and HVAC equipment. Finally, emissions for each building type can be multiplied by the prevalence of each building type to calculate total emissions.

Another bottom-up approach comes out of the Vulcan Project which measures CO$_2$ emissions at fine spatial and temporal resolutions, using networks of ground and air remote sensing technologies [@Asefi-Najafabady2014]. @Gurney2012 present results for the city of Indianapolis to understand the origins of its emissions, enabling decision makers to implement mitigation strategies, which are both effective and low cost.

Bottom-up methods often depend on high-tech tools including: sensor technology to measure energy, water, and pollutant fluxes; GIS and remote sensing devices to collect information on land-use, thermal radiance and rainfall; and advanced numerical modelling to simulate resource fluxes [@Chrysoulakis2009]. An alternative low-tech approach is to survey residents of a city about their resource use habits; for instance, deriving information on urban water flows by asking householders about their typical dishwasher loads and shower durations [@Eberlein2014].

### Merits, limitations, and a complementary approach

Top-down approaches are methodologically simple, but they do not nurture an appreciation of the ultimate causes of emissions or other environmental impacts [@Kellett2013], and are thus unable to predict how metabolic flows might change under different scenarios, hence the power of bottom-up methods which can be used to test scenarios and policies. Kellett et al. exemplify this in their neighbourhood emissions model by altering land-use, building efficiency, transport fuels, and consumer behaviour to observe how overall emissions change.

@Zhang2013 traces the evolution of the UM concept to arrive at the conclusion that more attention should be paid to the *middle* of a system. Starting with Wolman's seminal study, UM understood a city to be a linear system into and out of which resources flowed. On this view, sustainability efforts are focussed on minimising the inputs and outputs. This understanding was refined by @Giradet1990, who suggested that in addition to minimising resource inputs (e.g. by using solar energy and more efficient energy processes such as CHP), cities should be adopting circular metabolisms, whereby outputs could be reused as inputs through waste recycling. Both of these are black-box representations, where there is no consideration of mechanisms at play within the city. Thus @Zhang2009 proposed a network-process model in which research considers how resources move within a system. Specifically that work (and its offspring, such as @Li2011) considers the economic sectors (nodes) within a system, and the degree to which they are dependent upon one another by resource flows (links). Such information is useful to help identify potential problems for an urban system (e.g. due to sectors competing for a limited resource).

[TODO: reproduce @Zhang2013's figure]

In this way, @Zhang2013 notes that both bottom-up and top-down approaches fail to consider the mechanisms within the urban system which determine its behaviour -- or as we have denoted it -- the *middle* of the system. The top-down approaches are well suited to identify the scale of metabolic problems, and the bottom-up approaches contribute understanding on the ultimate causes of problematic flows, but appreciation of the middle will add to the insights of bottom-up studies by revealing the role of internal mechanisms between the top and the bottom of an urban system. Thus Zhang argues research should prioritise quantitative analysis of an urban system's components, which models urban systems as a network of nodes and flows. This representation of a system provides a framework to understand how fluxes circulate between nodes, thus enabling researchers to test how management interventions and other scenarios will change the distribution of fluxes between nodes.

If these recommendations are to be realised, the urban metabolism field should seek a comprehensive understanding of what constitutes the middle to enable modelling to take place; i.e. identifying and describing the nodes and the links within metabolic networks. In Zhang's paper, the middle of the system is understood to be a set of economic sectors (represented by nodes), which consume and produce resources that transfer to between sectors (along links), as well as importing and exporting them. Such an approach means that Zhang and other authors have conducted UM studies which investigate the effect of the 'middle' of the system, using ecological network analysis (ENA) to investigate the extent to which different economic sectors are dependent on each other, and the implications for a city's overall metabolic flows [TODO: cite Zhang, Li, etc.]. This is discussed in more detail in Section [TODO: cross-ref to section in chapter 3].

However, to Zhang's economic sector perspective of a UM system's middle, we could propose an engineered-system perspective (as opposed to say an economic one). On this view, the nodes and links correspond to resource management processes (e.g. powerplants, water treatment units, and pipe networks) and resource flows, respectively (as per part (B) of Figure \ref{fig:metab}). Other authors have noted that there is a "poor mechanistic underlying urban metabolism" theory, thus providing a roadblock to finding ways for resource to be used more efficiently [TODO: cite Fernandex-Mena et al.]. Studying nodes and links could suggest how a city's mix of processes could meet resource demand in cheaper and greener ways, beyond demand-side management. As a case in point, consider how a city meets domestic heating demand: bottom-up studies could explore how measures such as thermal insulation and lower thermostat settings reduce fuel requirements at the top. But studying the middle would explore how investment in processes could reduce fuel usage, for example showing how how heat demand could be met by waste heat from power generation rather than gas boilers. This could enable the study of how a city's process mix, layout and scheduling can be optimised to maximise synergies, and thereby minimise a city's overall resource consumption and waste generation. Indeed, information optimisation strategies to improve UM is highlighted by @Zhang as a great need for future UM research (e.g. in comparison to accounting- and simulation-based studies).

In summary, UM can be considered as the study of how a cities flows, forms and functions relate. While there is work to be done to study each of these areas (both individually, and how they relate), within the study of flows, the arguments of @Zhang2013 can be extended to highlight a need to study how the processes within a city relate to each other, as an engineered system. Furthermore, @Zhang2013 points out the need for optimisation studies. This is the basis for the work of this thesis, namely to formulate an optimisation model which can take advantage of synergies between different resource management infrastructure) helps to meet this gap. In this way our work meets calls for IE perspectives on UM [@Clift2015] which (for example) identify future sustainable urban technologies.

<!--
In addition to summarising the evolution of UM research, @Zhang's also points out that 
identifies four ways the UM concept can be used, each building on the previous. First, there is UM theory (which has been discussed above in terms of linear, circular, and network representations of UM). Second, UM can be used for accounting and assessment, to quantify stocks and flows (perhaps using them to calculate performance indicators). Third, ideas of UM can be used to generate simulation models, used to study dynamics, perhaps to see how a metabolism might change under various scenarios. Finally, UM ideas can be used to inform optimization and regulation strategies, which seeks to improve a metabolism in relation to some objective through management interventions in the nodes and paths of a metabolic network. It is this last area which @Zhang identifies as having the greatest need for future research. 

[TODO: can this content be inserted earlier in the lit review?]

Our introduction to UM thus far has been focussed on the resource flows into, out of and within urban areas. However, other studies attempt to integrate such studies of *flows* with the studies of cities spatial and material *forms* and/or their socioeconomic *functions*. 
- (urban political ecology, the central focus of https://www.bartlett.ucl.ac.uk/dpu/latest/publications/dpu-working-papers/WP168.pdf), 
- relationships with hinterlands and wider/global markets
- form ("such as distribution and density of housing, infrastructure etc.) influence MFA... who has access and who benefits from them..."
  	- @Barles2010a
- socioeconomic functions: @Newmann1999

- or they only focus on one resource, they are not intersectoral. Indeed, as @Fernandez-Mena2016 states the issue, UM models [TODO: note this was originally written in relation to nutrient recycling loops]
- Another author who has independently come to a similar conclusion is [TODO: citation].

> "... may seldom consider a whole mass balance since some flows are sometimes not quantified and do not always follow elements  along their whole cycle... The poor mechanistic basis underlying urban metabolism may prevent their use for exploring and simulating options for more efficient recycling loops within social ecological systems."
-->

## Modelling in the modern world

<!--
Jargon:

- Sets
- Parameters
- Constraints
- Objective (Cons and Obj are the mathematical relationships: equations, inequalities, logical relationships)
- Variables

Techniques:

- Linear, nonlinear, heuristics (e.g. GAs) etc.
- Map out linear/non-linear problems, and the solution approaches
- There should be a brief outline of this (even if it's just a list of definitions) so the when they are referred to in the literature review, the reader knows what we are talking about.
-->

Given the need for greater understanding of the 'inside' of a UM system generally, and the engineered system specifically, what role can 'modelling' play to assist this cause (over and above the accounting and simulation tools typically used in UM)? Whenever models are used, it is important to justify their use, but it is especially important here specifically, as we introduce a new model to the urban metabolism field.

A model can be defines as "A simplified representation used to explain the workings of a real world system or even" [TODO: reference Wiktionary]. @Williams1999 highlights three benefits of building models:

1. The act of model building itself will reveal relationships that were previously unapparent.
2. The results my reveal courses of action which were otherwise unapparent.
3. One can experiment on a model in a way that may be impractical or unethical for a real system.

However, modelling is not without its critics, and these objections must be addressed before this thesis can propose, formulate and apply a new model to support measures to improve urban metabolism. Some only see crude reductionism in the way that mathematical programming seeks to quantify something, resting decisions on the numerical value of an equation. @Williams1999 points out that in fact all decisions will make quantitative evaluations implicitly, if not explicitly, and suggests modelling is at least honest and scientific. Others are sceptical of modelling, suggesting that innaccuracies in coefficient values will lead to inaccurate results. Williams responds by showing how models can be tested for a range of parameter values (to reflect uncertainty), for example establishing the ranges for which parameters can change with predictable effects on the values of variables and the objectives (for more detail on this, see lecture notes by Keirstead [TODO: Add reference]).

Having said that, blind, unquestioning faith should not be placed in models, rather they "should be used as one of a number of tools for decision making" [@Williams1999, p5] to test different options, and identify what is possible.

### Types of models

There are a number of types of model, which are summarised in Figure \ref{fig:models} (which is based on the @Williams1999's brief introduction to models). Models can be either *concrete* (such as a scaled-down construction of an aeroplane [TODO: or lab-simulation of resource management process]), or *abstract* (a conceptualised representation of a system). An abstract model could be purely *descriptive* (sometimes called 'conceptual'), such that it might graphically/visually/diagramatically represent some system, and is generally used to help people understand the real system. A classic example is the nitrogen cycle diagram, that many learn in school. It does not include any mathematical content, but it does visualise how plants, bacteria, the atmosphere, and other components convert nitrogen [TODO: http://www.bbc.co.uk/schools/gcsebitesize/science/add_gateway_pre_2011/greenworld/recyclingrev2.shtml]. 

\begin{figure}
	\centering
	\begin{spacing}{1.0}
	\sffamily
	\resizebox{\columnwidth}{!}{\input{05_model-development/models.pdf_tex}}
	\end{spacing}
	\caption{A summary of different types of models, based on \citet[Chapter 1]{Williams1999}.}
	\label{fig:models}
\end{figure}

Abstract models can also be mathematical. These models use mathematical relationships to encode the behaviour of some real-world phenomenon. One particular type of mathematical models are statistical models, which try to find a statistical relationships between two or more components, for example relating a persons age to height, so one can be predicted from the other. Other types of mathematical models include simulation models, and optimisation models (also known as mathematical programming). Both of these use equations, inequalities and logical dependencies to represent the dynamics of a system. A simulation model attempts to predict the performance of a real world system, for example could be the length of a traffic queue given a particular system of traffic signals [TODO: http://ac.els-cdn.com/S1877050912004619/1-s2.0-S1877050912004619-main.pdf?_tid=81fcafc0-4f2a-11e6-b3a2-00000aacb35f&acdnat=1469095647_391a940124c0a56d0dfcae6fd9b4f24a]. In these models, one can test scenarios, such as seeing how queue lengths changes when commuters alter their departure times. Optimization models compute the conditions under which a system will perform best, by minimising some quantity, such as traffic congestion [TODO: cite file:///home/tr608/Downloads/network-performance-optimization-using-a-queueing-network-model.pdf]). This model uses a set of linear and/or nonlinear equations consisting of parameters (known data, such as road lengths), and variables (unknowns which represent choices, e.g. the length of time for a signal to display a green light, etc.). These equations represent the physics of a system, as well as real-world constraints (e.g. minimum allowable time for a green signal). Mathematical routines operate on the equations to choose the variable values which minimise the of interest.

### Modelling within UM

The UM literature contains examples of all the model types mentioned above, which can be seen by using the Scopus tool to search for relevant articles, using the search term `urban metabolism AND model OR modelling`[^search]. 

[^search]: The full search term is available at \\url{http://www.scopus.com/results/results.uri?sort=plf-f&src=s&st1=urban+metabolism+AND+model+OR+modelling&sid=A080B1BFA7BBE9DC169DA27B04E5945E.f594dyPDCy4K3aQHRor6A%3a150&sot=b&sdt=cl&cluster=scosubjabbr%2c%22MEDI%22%2cf%2c%22BIOC%22%2cf%2c%22PHAR%22%2cf%2c%22NURS%22%2cf%2c%22CHEM%22%2cf%2c%22NEUR%22%2cf%2c%22IMMU%22%2cf%2c%22MATH%22%2cf%2c%22BUSI%22%2cf%2c%22ARTS%22%2cf%2c%22PSYC%22%2cf%2c%22HEAL%22%2cf%2c%22MULT%22%2cf%2c%22VETE%22%2cf%2c%22Undefined%22%2cf&sessionSearchId=A080B1BFA7BBE9DC169DA27B04E5945E.f594dyPDCy4K3aQHRor6A%3a150&origin=savedSearchNewOnly&txGid=A080B1BFA7BBE9DC169DA27B04E5945E.f594dyPDCy4K3aQHRor6A%3a15}]. This search excludes irrelevant subject areas (such as medicine).

This returned 239 results which was manually reduced to 108 after removing articles which were  inaccessible, not published in English, only tangentially related to UM, or did not come under the definition of 'model' as described above. Looking further at the remaining results, each paper was classified according to three three categories:

\begin{description}
\item[Type] This refers to the model types mentioned above. An example of a conceptual model is that of \citet{Newman1999a}, who proposes the `Extended Metabolism Model of the City' (p.220) which suggests that when trying to understand an area's metabolism, this should include 'livability' (e.g. income, housing, community etc.) in addition to the resource inputs and outputs represented by \citet{Wolman1965}'s conceptual model. An example of a statitical model is that of \citet{Liang2014} who identify a statistical relationship between the level of a city's nighttime lighting (as seen by satellites) and the city's steel stock, such that the latter can be predicted from the former. \citet{Kellet2013} provides an example of a simulation model, in which a city's emissions are quantified from equations which calculate the contributions from building, transport, human, and vegetations sources. Finally, an optimisation model is put forward by \citet{Pederson2013} who use heuristics to 'evolve' optimised city designs, through new building envelopes, road networks, public spaces etc. according to the metabolic capabilities and limitations.

[TODO: Add note on how some simulation models adopt statistical models?]

\item[Focus] UM models have different foci. Here, there are two main subcategoreis to consider: those with a \emphj{resource} focus, and those with a {non-resource} focus. The resource-focussed subcategory is further divided:

\begin{itemize}
\item \emph{single-resource focus}, such as \citet{Zeng2014}, who simulate urban water flows among various facilities and end uses);
\item \emph{multiple-resource focus}, such as \citet{Liang2011}, who model how various energy and material flows including coal, water, biomass and pollutants, change under proposed policies.
\item \emph{integrated-resource focus} models which unite multiple resource types under a single value system, such as \citet{Huang2005} who use emergy\footnote{\emph{Emergy} is further explained in Section [TODO:]} to encapsulate various flows including solar energy, rain, and fossil fuels.
\end{itemize}

Non-resource foci include the following divisions:

\begin{itemize}
\item \emph{urban form}, such as \citet{Liang2014} (mentioned above) which quantifies a city's steel stock.
\item \emph{socioeconomics}, such as \citet{Newman1999}, (mentioned above) who suggest UM studies should consider livability along with metabolic flows
\item \emph{environment}, such as \citet{Ye2011} who  models which unite multiple resource types under a single value system, such as \citet{Huang2005} who considers the greenhouse gas emissions of an area as predicted by household construction characteristics.
\end{itemize}

\item[Level] The third way UM models are classified here is according to the level at which they represent components of an urban system (either conceptually or mathematically), which can be as follows:

\begin{itemize}
\item \emph{Low}-level models capture the most detail, considering those models which quantify resource flows occuring among an urban area's resource management processes and/or its points of demand. One example is the model of \cite{Zeng2014} who quantify the water flows between different sectors (domestic, industrial etc.) and systems (supply, treatment etc.). Alternatively, this could denote models where equations for bottom-up mathematical descriptions of system components (e.g. \citet{Kellet2013}, described earlier).

\item \emph{Medium} At the next level of detail, this level includes models in which conceptual or mathematical relationships are defined for a UM system's organisational sectors and/or socioeconomic functions. For example, \citet{Zhang2010a} use ecological network analysis\footnote{Ecological network analysis (ENA) is described in detail in Section [TODO:]} to model the resource-interdependence of 17 economic sectors to each other. In other medium-level models, \citet{Fung2005} relates an area's institutional activities to its sustainability, and \citet{Huang2005} relates energy flows to urban development.
\item \emph{High} Models belonging to this level capture system dynamics in their broadest sense, using ratios. For example, relating society size and transport volumes as in \citet{Fischer-Kowalski2004}'s model, or calculating a long-term time series for sectoral energy demand based on the upstream energy consumption data as in \citet{Baynes2012a}.
\end{itemize}

\end{description}

Each of the 108 papers captured in the search and filtering of the UM modelling literature are plotted as a point on Figure \ref{fig:UM-model-lit}. The point is coloured according to the model **type**, while its **focus** and **level** is represented by its position on the x-y plane. The models cited above are labelled on the plot.

Examining the plot, it is possible note features and gaps in the UM modelling landscape, such as the dominance of simulation models and models which focus on how an area uses resources. However, when it comes to optimisation models, there is only one (which considers urban form). This suggests that this thesis can contribute a model whose purpose is to consider the **optimisation** of energy, water and waste flows (i.e. **multiple resources**) between resource management processes (i.e. **low level**).

[TODO: remove the NA points on the plot]

```{r metab-lit-review, results="asis"}
###--------------------------------------------------
## PREPROCESSING
### From lit-metab-modelling.csv, we used R to remove rows with states!="cut")
### From lit-keep-maybe.csv, we summarised the attributes for each paper, and identified more papers to cut
### We are left with lit-final-cut.csv, which is used below
###--------------------------------------------------

###--------------------------------------------------
### Set up the database for cluster analysis
###--------------------------------------------------


#setwd("02_lit-review")
setwd(getwd())
library(dplyr)

### Load in literature titles and attributes, removing the remaining papers marked 'CUT'
#lit_draft_cut <- read.csv("02_lit-review/lit-final-cut-alt.csv")
lit_draft_cut <- read.csv("02_lit-review/lit-final-cut-thesis.csv")
lit_final_cut <- filter(lit_draft_cut, type!="CUT")

## TODO: merge some of the model use groups together for clarity (e.g. include 'other' grouping)

## Only keep variables relevant for our cluster analysis
lit_final_cut <- select(lit_final_cut,
			c(Title, type, method, techniques.broad, techniques, techniques.IO, techniques.other, focus.broad.cat, focus.broad, focus, focus.multiple, focus.other, use, use.other, text.label))

```


```{r metab-lit-review-plot, fig.height=5, fig.width=8, fig.cap="An overview of the UM modelling literature.\\label{fig:UM-model-lit}"} 

###--------------------------------------------------
### Select and order attributes for ordinal data
### E.g. for plotting, it is helpful for "Low-level", "Medium-level", and "High-level" to appear in this order
###--------------------------------------------------

## Select attributes to be plotted in the analysis
lit_main_cats <- select(lit_final_cut, c(type, method, techniques.broad, techniques, focus.broad.cat, focus.broad, use, text.label))

## Order attributes for ordinal data (e.g. for plotting, it is helpful for "Low-level", "Medium-level", and "High-level" to appear in this order)
lit_main_cats <- transform(lit_main_cats,
			   type=factor(type,
			     levels=c("conceptual", "mathematical", "various"),
			     ordered=TRUE),
			   techniques.broad=factor(techniques.broad,
			     levels=c("low", "medium", "high"),
			     ordered=TRUE),
			   techniques=factor(techniques,
			     levels=c("Bottom-up mathematical description", "ENA", "integrated", "LCA", "mass and/or energy balance", "mathematical representation of subsystems", "other", "ratios", "regression", "relate actors", "relate various", "various")),
			   focus.broad.cat=factor(focus.broad.cat,
			     levels=c("resource", "other", "methodology"),
			     ordered=TRUE),
			   focus.broad=factor(focus.broad,
			     levels=c("single resource", "multiple resources", "integrated", "form", "socioeconomic", "environment", "methodology"),
			     ordered=TRUE),
			   use=factor(use,
			     levels=c("accounting", "forecasting", "other", "scenario analysis", "strategic planning", "system understanding/improvements", "theory")))

###--------------------------------------------------
### Plot results to identify clusters
###--------------------------------------------------

plot_cluster <- ggplot(lit_main_cats, aes(y=techniques.broad, x=focus.broad)) +
  geom_jitter(aes(colour=factor(method)), width=0.1, height=0.1) +
  geom_text(aes(label=text.label, colour=factor(method)), size = 2) +
  theme_bw() +
  theme(axis.text.x = element_text(hjust=1, angle=30),
	legend.position="bottom",
	legend.direction="vertical") +
  guides(col=guide_legend(ncol=2)) +
  xlab("Focus") +
  ylab("Level") +
  scale_colour_discrete(name="Type")
#  facet_wrap(~focus.broad.cat, scales="free_y", ncol=1)
plot_cluster
```

## Review of resource managagement optimisation modelling

So far, this chapter has introduced UM as a research area that can support urban sustainability measures, and has shown that modelling is one means by which this can happen. The work of this thesis is to add to UM modelling capabilities a model which can optimise the simultaneous design of urban energy, water, and waste systems, so as to take advantage of intersectoral synergies, and thus improve an area's metabolism. To assist that cause, this section reviews a number of 'resource management optimisation models'[^ROM]. This has two purposes: first, to confirm the need for a model which can simultaneously optimise multiple resource management systems at the urban scale (thus complementing the findings above that the UM modelling literature includes no such models); and second, to suggest possible methodologies which can be adapted in this thesis.

[^ROM]: Note that 'resource management optimisation modelling' is not a subject area which has a formal definition (unlike say, 'urban energy systems modelling' [TODO: cite @Keirstead review paper definition], rather it is used here to refer generally to optimisation models which are used to assist system managers improve the management of an energy or material resource for which they are responsible, and can incorporate everything from the efficient production of a single resource in some component of a plant [TODO: cite example], up to global strategies to manage [TODO: cite example, e.g. biomass].

### An introduction to the resource optimisation modelling literature

Optimisation modelling (or mathematical programming) is generally used in to help planners and policy makers determine the design and operation of the infrastructure which extracts, refines, converts, and transports resources. Often these optimisation models take the form of a 'minimum cost network flow' problems [@Williams1999, p81], in which a set of equations are then solved to select an mix, layout, and operation schedule for resource management infrastructure, e.g. to maximise profit or minimise emissions.

The most famous resource management models are arguably the models used to design energy systems at the national scale, such as MARKAL which attempts to plan an energy system, considering resource availability, infrastructural capabilities, technological possibilities, as taxation and policy regimes [TODO: https://www.ucl.ac.uk/energy-models/models/uk-markal]. It is used by governments, NGOs, and researchers around the world to help propose and plan energy strategies [TODO: https://www.epa.gov/air-research/epaus9r-energy-systems-database-use-market-allocation-markal-model].

Of most interest to this thesis however, are optimisation models formulated for the urban scale, and in particular, those that consider energy, water, and waste systems. These three resource types in particular have been chosen as their need for management needs are common to a city's 'bottom' [TODO: cross-ref the figure] (domestic, industrial, processing). These resources are generally the responsibility of utility companies (public or private), rather than individuals. Furthermore, energy, water and waste systems are considered three of the "lifeline infrastructures" (http://ro.uow.edu.au/cgi/viewcontent.cgi?article=1053&context=isngi2013), and in particular the three which involve resource conversions and transport (unlike communications and transport).

One urban-scale example of a resource management optimisation model is the urban energy systems model of @Keirstead2012. In one application, the model evaluates energy supply for a UK eco-town, focussing on the potential benefits of biomass-based systems[^Keirstead-other-applications]. A set of linear equations represent the resource quantities (e.g. biomass, heat, electricity, etc.) supplied to and removed from zones within the town at any given time. Parameters represent the zonal resource demands, resource availability, and technology behaviour. Variables represent whether a technology is present in a given zone, and at what rate is operates, as well as a schedule of resource movements within and without the city.

[^Keirstead-other-applications]: Other applications of this model include [TODO: complete...]

Optimisation models also are used to help plan urban water supply networks. For example @Zanganeh2010's model optimises the performance of an area's existing water network, choosing reservoir heights, pump sizes. @Lejano2006 applies optimisation modelling to a network design, starting with the spatial distribution of customer demands, it selects appropriate locations for the pipes. Some water optimisation models have ambitions greater than merely meeting demand, but also seek to minimise freshwater consumption through employing water reclamation processes, water saving technologies -- examples of these can be found in @Lim2010 and @Makropoulos2008.
<!--
@Keedwell2006 (e.g. decision variables include water pipe dimensions)
-->

Finally, there are a number of waste management planning models such as @Guo2009 and @Li2006. These models allocate waste flows from their point of generation to various management facilities, to inform longterm decisions. (i.e. investment choices and capacity requirements) [TODO: Add note on the two-stage methodologies].

### An overview of the resource optimisation modelling literature

The energy, water and waste models introduced above vary in their formulations, according to their different purposes. Moving from these specific examples, to consider the resource optimisation models more generally, a quasi-systematic literature review can help to identify trends and patterns in how model formulations vary according to purpose. This will help to confirm gaps in the literature which can be met by this thesis, as well as precedent methods which can be used in this thesis. The first stage of the review is to use the Scopus tool to search for relevant literature, using the search term `energy AND water AND waste AND optimization model`, and excluding irrelevant subject areas (such as psychology) from the search [^search-res-models]. 

[^search-res-models]: The full search term is available at \\url{http://www.scopus.com/results/results.uri?sort=r-f&src=s&sid=492559A18BFC5EDC7C12FF9547004CF1.fM4vPBipdL1BpirDq5Cw%3a100&sot=a&sdt=cl&cluster=scosubjabbr%2c%22CHEM%22%2cf%2bscosubtype%2c%22ar%22%2ct%2bscosubjabbr%2c%22BIOC%22%2cf%2c%22MATE%22%2cf%2c%22PHYS%22%2cf%2c%22MEDI%22%2cf%2c%22IMMU%22%2cf%2c%22MATH%22%2cf%2c%22SOCI%22%2cf%2c%22ECON%22%2cf%2c%22PHAR%22%2cf%2c%22NURS%22%2cf%2c%22VETE%22%2cf%2c%22ARTS%22%2cf%2c%22HEAL%22%2cf%2c%22NEUR%22%2cf%2c%22PSYC%22%2cf%2c%22Undefined%22%2cf&sessionSearchId=492559A18BFC5EDC7C12FF9547004CF1.fM4vPBipdL1BpirDq5Cw%3a100&origin=savedSearchNewOnly&txGid=492559A18BFC5EDC7C12FF9547004CF1.fM4vPBipdL1BpirDq5Cw%3a10}.

```{r model-lit-review-load, results="asis"}

## Packages required by our analysis of the literature
library(tm)
library(dplyr)
library(ggplot2)
library(reshape2)

## Load in all titles
lit <- read.csv("02_lit-review/lit-resource-modelling.csv")
titles <- as.character(lit$Title) # The unedited paper titles

## Save number of files in original list (for output into document)
uncut_list_size <- dim(lit)[1]
uncut_list_size <- prettyNum(uncut_list_size, big.mark=",") # Insert a 1,000s comma separator
```

```{r model-lit-review-tm, results="asis"}

## Merge titles into single block of text
text_full <- paste(titles, collapse=" ")

## Edit the text for mining
text_source <- VectorSource(text_full)
corpus <- Corpus(text_source)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removeWords, stopwords("english"))

## Create the document-term matrix, and count word frequency
dtm <- DocumentTermMatrix(corpus)
dtm2 <- as.matrix(dtm)
frequency <- colSums(dtm2)
frequency <- sort(frequency, decreasing=TRUE)

## Create dataframe of word frequency
words <- names(frequency)
freq <- as.data.frame(frequency)$frequency
word_freq <- data.frame(words, freq) # 11,967 unique words in total

## Save word-frequency list for manual editing
write.csv(word_freq, "02_lit-review/words-pre-cut.csv", row.names=FALSE)
```

```{r model-lit-review-listReduction, results="asis"}

###--------------------------------------------------
### Manually reduce the list of words (removing those which don't refer to resources, e.g. 'network')
##### Original list: words-pre-cut.csv (11,967 unique words)
##### Reduced list: words-post-cut.csv (366 unique words)
### Manually categorise remaining words (e.g. "electricity" --> "energy"), and store in word-cats.csv
### Apply word-frequency analysis to identify:
##### (A) the number of word matches for each title
##### (B) the number of category matches for each title
### Plot and save results
###--------------------------------------------------

## Load manually-reduced database of word frequencies
word_freq_cut <- read.csv("02_lit-review/words-post-cut.csv")

```
[^unique-words]: This list of resources and their categories is supplied at [TODO: add URL].

```{r model-lit-review-categs, results="asis"}

## Load in categorisation of words
word_cats <- read.csv("02_lit-review/word-cats.csv") ## TODO: Remove the 'nonresource category'
```

```{r model-lit-review-categMatches, results="asis"}

## List of words to match
text_cut <- read.csv("02_lit-review/text_cut.csv")$word

## Set up vectors to store the results of the word-frequency analysis
T <- length(titles)
word_matches <- length(T)
cat_matches <- length(T)
cat_matches_list <- length(T)
optim <- rep(1, T)

## Loop over all titles, to identify the number of matching words
for(i in 1:T){

  ## Convert title into a vector where each word is a unique element
  title <- titles[i]
  title <- tolower(title) # Convert to lowercase
  title <- gsub("[[:punct:]]", " ", title) # Replace punctuation with spaces
  title <- unlist(strsplit(title, split=" ")) # Convert to vector

  ## For each title, count the number of words matching those in our list
  intersections <- intersect(title, text_cut)
  word_matches[i] <- length(intersections) ## a vector of how many matching words

  ## For each title, identify the number of unique categories containing the matched words
  categs <- filter(word_cats, words %in% intersections)

  ## For each title, count the number of unique categories containing the matched words
  cat_matches[i] <- length(unique(categs$category))

  ## For each title, list the unique categories containing the matched words
  categs_list <- as.character(sort(unique(categs$category)))
  categs_list <- paste(categs_list, sep="", collapse=", ")
  cat_matches_list[i] <- categs_list

  ## Identify the titles with 'optimi[s/z]ation', or similar
  optims <- match(c("optimization",
	  	 "optimisation",
	  	 "optimized",
	  	 "optimised",
	  	 "optimal"), title)

  if(all(is.na(optims)) == TRUE){
    optim[i] <- 0
  }

}

## Store results for each title in dataframe
title_matches <- data.frame(titles, word_matches, cat_matches, cat_matches_list, optim)
```

```{r model-lit-review-plot, results="asis"}
## Save titles and category matches (in original order)
write.csv(title_matches, "02_lit-review/title-matches-original-order.csv", row.names=FALSE)
```

```{r model-lit-review-optimReduction, results="asis"}

## As above, but just the titles containing 'optimization' and similar words
title_matches_optim <- filter(title_matches, optim==1)
write.csv(title_matches_optim, "02_lit-review/title-matches-optim-original-order.csv", row.names=FALSE)

## Save titles and category matches (sorted according to the frequency of category matches)
title_matches <- arrange(title_matches, desc(cat_matches))
write.csv(title_matches, "02_lit-review/title-matches.csv", row.names=FALSE)
```

```{r model-lit-review-categMatchFreq, results="asis"}

###--------------------------------------------------
### Make dot plot of category combinations in the literature
###--------------------------------------------------

## Get frequency of each combination of categories
combo_freqs <- data.frame(count(title_matches, cat_matches_list))
names(combo_freqs) <- c("Combinations", "CatFreq")

## Get frequency of 'optimization' within each category
optim_freqs <- title_matches %>% group_by(cat_matches_list) %>% summarize(sum(optim))
optim_freqs <- data.frame(optim_freqs)
names(optim_freqs) <- c("Combinations", "OptimFreq")

combo_freqs <- merge(combo_freqs, optim_freqs)

## Incorporate the number of categories for each combination (so plot can be faceted according to this)
tmp <- title_matches[!duplicated(title_matches$cat_matches_list), ]
tmp <- select(tmp, c(cat_matches_list, cat_matches))
names(tmp) <- c("Combinations", "n")
combo_freqs <- merge(combo_freqs, tmp)

## Create a column of titles (to be printed as facet_wrap strip titles)
combo_freqs$NumCats <- combo_freqs$n
combo_freqs[combo_freqs$n==0, ]$NumCats <- "Zero category matches"
combo_freqs[combo_freqs$n==1, ]$NumCats <- "One category match"
combo_freqs[combo_freqs$n==2, ]$NumCats <- "Two category matches"
combo_freqs[combo_freqs$n==3, ]$NumCats <- "Three category matches"
combo_freqs[combo_freqs$n==4, ]$NumCats <- "Four category matches"
combo_freqs[combo_freqs$n==5, ]$NumCats <- "Five category matches"

## Sort so number of categories will be faceted in ascending order
combo_freqs$NumCats <- factor(combo_freqs$NumCats,
			  levels= combo_freqs$NumCats[order(combo_freqs$n)])

## Sort so combination frequencies will be plotted in ascending order
combo_freqs$Combinations <- factor(combo_freqs$Combinations,
			  levels= combo_freqs$Combinations[order(combo_freqs$CatFreq)])

## Reshape so that CatFreq and OptimFreq can both be plotted as points
combo_freqs <- select(combo_freqs, -c(n))
combo_freqs <- melt(combo_freqs, id.vars=c("Combinations", "NumCats"), value.name="Frequency")
```

```{r model-lit-review-reduction, results="asis"}

###--------------------------------------------------
### POST-PROCESSING
### Copy title-matches-optim-original-order.csv --> title-matches-optim-original-order-edit.csv,
### (A) manually identify irrelevent papers with 'CUT'
### (B) assign a scale (e.g. 'domestic', 'regional' etc.) to each model
### (C) assign a level of integration ('none', 'integrated', or 'highly integrated') to each model
### This is so we can analyse the content of the remaining papers
###--------------------------------------------------

title_matches_edit <- read.csv("02_lit-review/title-matches-optim-original-order-edit-demands.csv")
lit <- title_matches_edit

## Only keep the relevant literature
lit <- filter(lit, notes.1!="CUT") ## 135 models remain

## Save number of files in reduced list (for output into document)
cut_list_size <- dim(lit)[1]
cut_list_size <- prettyNum(cut_list_size, big.mark=",") # Insert a 1,000s comma separator
```

This step returned `r uncut_list_size` results, which were filtered using R code to automatically remove titles not containing words related to 'optimization' [TODO: add footnote with URL], and titles unrelated to resource management[^filter-words]; before manually removing other irrelevant titles. This left `r cut_list_size` documents, which describe optimisation models at various scales, from optimising some component in a powerplant [TODO: example], to planning strategies at a regional level [TODO: example].

[^filter-words]: We started by removing common words (e.g. 'the') using the functionality of the textmining package `tm` in R, before identifying 11,967 unique words. From this automatically generated list, we manually removed words which did not refer to resources (e.g. 'network'), leaving 366 unique words. Only titles containing words from this list remained in our review. [TODO: add note on ]

[TODO: note difference between concrete (i.e. experimental) and abstract models.]

Across the different models, with their varying purposes, we could identify their various traits in order to highlight the need for our intersectoral synergy urban model, as well identify a suitable methodology to use[^sys-review].  There are many aspects we could consider (e.g. spatial and temporal resolution, time horizon, incorporation of endogenous resource demands, integration capabilities with other models, etc.), but here, we focus on three characteristics most relevant to our model, namely: the **detail** to which models make infrastructure planning decisions; the **methods** used to solve the equations; and the degree to which they integrate different resource management systems in order investigate synergies (**integration**). Each of these dimensions are now considered in more detail:

[^sys-review]: This modelling review procedure to identify modelling challenges and opportunities, has similarities with those used elsewhere -- see for example the review of urban energy systems models in @Keirstead2012b.

\begin{description}
\item[Detail] Some optimisation models are used in research, or the early exploratory stages of a system design, whereas other models are used to generate the precision required to design and operate a real-world system. These models tend to differ in terms of the detail to which they design a model. (Note: this is not the same as spatial or temporal scale, though it maybe more likely that models that consider smaller geographical areas and/or shorter time horizons can be more detailed.)

The most detailed models make 'low-level' decisions, optimising variables such as pipe dimensions and their precise location [TODO: water example], and biomass moisture content in a gasification plant [TODO: cite Synthesis and thermo-economic design optimization of wood-gasifier-SOFC systems for small scale applications]. [TODO: note the biomass superstructure models for high-level.]

At the high-level, the design considers a system's superstructure, representing a system as a network of resource sinks and sources, and their connections between them. Often, their job is to identify optimal resource transfers between sinks and sources, to meet some goal. They may optimise a spatial layout (the location of, and distance between sinks and sources), but they do not go into the precision of detailed design. Examples include @Keirstead2012's urban energy system (introduced in Section [TODO:], above), the urban water system models of @Lim2010 and @Makropoulos2008, whose models maximise opportunities for wastewater reuse, by identifying urban sinks and sources of waters of various different contamination levels, and optimising how they might be connected.

\item[Methods] Solution methods to solve the optimisation which vary according to the formulation, of which there are two broad categories: linear and nonlinear. Linear models include many of the energy systems models (including @Keirstead2012), which are based on mass or energy balances which can be linearly formulated [TODO: list examples from the spreadsheet]. There are subsets of linear problems, for example, some variables must take integer values (e.g. defining the number of a particular process in a location), and thus employ mixed-integer linear programming (MILP). Linear models can also have uncertain parameters, by defining them as probability distributions. This is especially true of waste management models, where long-term waste generation rates are uncertain. These stochastic linear models require multiple-stage methods to solve [TODO: list examples from the spreadsheet].

Nonlinear formulations are often found in water management models. The first reason for this is that they many are based upon hydraulic equations which include the product of two or more variables\footnote{To take one example (which is considered in more detail in Section [TODO:]), the potential energy of a mass of water due to its elevation is given by $\mbox{mass} \times \mbox{gravity} \times \mbox{elevation}$, where both mass and elevation can be variables.}, especially the case for the low-level modles [TODO: list examples from the spreadsheet]. But nonlinearity in the high-level superstructure models, in order to model water contamination levels, when different water/wastewater streams mix [TODO: list examples from the spreadsheet].

Nonlinear problems can be solved using the nonlinear programming methods [TODO: examples of NLP and MINLP], but these are computationally expensive, so heuristics are often used to obtain near-optimal solutions with less effort. These heuristics often start with a possible set of variable values, and the imitate processes in nature to modify these solutions until a near-optimal solution is found. Examples include genetic algorithms which follow evolutionary procedures [TODO: example]; and particle swarm optimisation, which mimic the flocking of birds [TODO: example].

\item[Integration] Thirdly, resource management optimisation models can vary in the extent to which they integrate different resource management systems. Here, we define three levels, each of which indicates to what extent a model considers intersectoral synergies is part of the optimisation (diagramatically represented in Figure \ref{fig:integn-levels}).

\begin{figure}
  \centering
  \includegraphics[width=\textwidth]{02_lit-review/integration-levels}
  \caption{Representation of low-, medium-, and high-levels of integration in resource optimisation modelling.}
  \label{fig:integn-levels}
\end{figure}

\begin{itemize}
\item \textbf{No integration.} These models consider just one resource system, such as the urban energy systems model of \citet{Keirstead2012}, or the urban water network model of \citet{@Keedwell2006}.
\item \textbf{Integrated.} These models will optimise for one resource, but while considering other systems [TODO: examples]. While these models may identify synergetic opportunities, this is not their main purpose.
\item \textbf{Highly integrated.} These models try to simultaneously meet the demands for more than one resource management system. These models have as their main purpose, the optimisation of synergies between different resource management systems. Examples include [TODO: cite examples from IE]. 

\end{itemize}

The resource management optimisation models in our filtered list have been classified according to their level of integraion, and Figure \ref{fig:model-integration} plots each model as a point, located according to its scale and integration.

\end{description}

```{r model-lit-review-categMatchPlot, fig.height=5, fig.cap="Model integration levels.\\label{fig:model-integration}"}

###--------------------------------------------------
### Plot overview of literature
###--------------------------------------------------


unique_levels <- unique(lit$level)
unique_cats <- unique(lit$cat_matches_list)
unique_optimised.systems <- unique(lit$optimised.system.s.)

## Sort so levels are plotted in ascending order
lit <- transform(lit,
		 scale=factor(scale,
		   levels=c("component",
			    "domestic", 
			    "plant",
			    "plant (multiple components)",
			    "plant (couple)",
			    "refinery/chem. plant",
			    "EIP",
			    "city",
			    "region",
			    "agricultural area",
			    "global",
			    "various"),
		    ordered=TRUE),
		 integration=factor(integration,
		    levels=c("none",
			    "integrated",
			    "highly integrated"),
		    ordered=TRUE),
		 cat_matches_list=factor(cat_matches_list,
		   levels=c("various, waste",
			   "various, water",
			   "waste, water",
			   "energy, various",
			   "energy, waste",
			   "energy, water",
			   "energy, various, waste",
			   "energy, various, water",
			   "energy, waste, water",
			   "energy, water, waste",
			   "various, waste, water",
			   "energy, various, waste, water"),
		    ordered=TRUE))

## Add column to colour the points within the site and the city regions
lit$colour <- "noColour"
lit[lit$Scale=="region", "colour"]  <- "colour"
lit[lit$Scale=="city", "colour"]  <- "colour"
lit[lit$Scale=="EIP", "colour"]  <- "colour"
lit[lit$Scale=="refinery/chem. plant", "colour"]  <- "colour"

## Plot as dot plot: integration vs. scale
plot_lit_int.scale <- ggplot(lit, aes(scale, integration)) +
#  geom_jitter(aes(colour=optimised.system.s.)) +
  geom_jitter(aes(colour=opt.systems.summary)) +
  xlab("Scale") +
  ylab("System integration") +
  theme_bw() +
  theme(axis.text.x = element_text(hjust=1, angle=30),
	legend.position = "bottom",
	legend.direction = "vertical") +
  guides(col=guide_legend(ncol=2))
plot_lit_int.scale

### Plot as dot plot: focus vs. methods
#plot_lit_focus.methods <- ggplot(lit, aes(optimised.system.s., methods)) +
#  geom_jitter(aes(colour=opt.systems.summary)) +
#  xlab("Optimised systems") +
#  ylab("Methods") +
#  theme_bw() +
#  theme(axis.text.x = element_text(hjust=1, angle=30),
#	legend.position = "bottom",
#	legend.direction = "vertical") +
#  guides(col=guide_legend(ncol=2))
#plot_lit_focus.methods

```

[TODO: note this reference "Optimization methods applied to the design of eco-industrial parks: A literature review" (review of literature (methods) where EIP's engage in the exchange of energy/materials/water (similar to our paper). Conclusions could be interesting).]

Having described how resource optimisation models can be classified by their detail, methods, and integration level, it is now possible to propose where the model formulated in this thesis fits in to these categories. First with respect to the level of integration, this thesis will propose a highly integrated model. Presently, these are rare in the literature, and are rarer still at the urban scale where models tend to only consider one resource sector in isolation (e.g. an urban energy system), or the integration of energy or water systems into other systems. The search only captured two models classed as highly integrated, both of which integrate urban water and wastewater systems, to minimise freshwater consumption. Thus current optimisation models use to help plan urban resource management systems impose a ceiling on potential material and energy savings, by not considering energy, water and waste systems in combination.

There are however a few highly integrated models, which attempt to take advantage of the co-location of various resource management infrastructure, to use synergies between different systems [TODO: reference], where the wastes and by-products of one process become the inputs to another, for example for refineries, where the co-functioning of energy, water systems used in chemical production is simultaneously optimised [TODO: cite example]. The highly integrated models closest to the ambitions of this thesis are formulated for eco-industrial parks (EIPs). These models try to realise maximum benefit from IE possibilities, and thereby identify the most beneficial energy and material exchanges between processes [TODO: cite an example?].
<!--
 However, as the review article by @Boix2015 notes, these models emphasize "...either the water network, or the energy links or waste disposal facilities but never the whole networking" (p.314). 
-->

Moving to the detail category, when considering multiple resource system types, it would be prudent to start with a simple representation of the various systems, before delving into the intricacies of the detail design and operation of the systems, which require specialist expertise regarding the systems being modelled. This means looking to high-level models.

Finally, with regards to method, the choice between linear and nonlinear formulations will be weighed up in Section [TODO:]

## Summary of gaps in the literature and the contribution this thesis can make

As the Introduction in Chapter 1 argued, cities provide an opportunity to deliver goods and services more efficiently, if only they were to take advantage of the synergies possible between energy, water and waste management systems. In order to move towards such a goal, this chapter has reviewed two research areas which consider how cities can use resources more efficiently.

The first research area is that of UM, where the review showed first that there can be more research into how the resource management processes used by an urban area affect its metabolism; and second, that while modelling is commonly adopted within UM, there is space for a resource systems model [TODO: rephrase]. This can be achieved if cities are considered as an 'engineered system', made up of a network of resource management processes, through which resources from beyond the city boundary are converted, in order to meet demand for energy, and water (similarly, the network manages wastes, and returns them to the wider environment).

The second research area studies here was that of resource optimisation modelling. A review of the literature found that at the urban scale, there were no models which integrated the design of energy, water and waste management systems (nevertheless, there were models which integrated the planning of more than one system at other scales).

These two gaps in these research fields can both be addressed in this thesis. Introducing the proposed network representation of a city into the conceptual model of an area's UM, opens up the possibility of using optimisation modelling to design a model which can help researchers, planners and policy makers plan resource management to adopt principles of industrial ecology found in EIPs, and take advantages of the synergies between different resource management systems. 

In this way, the main challenge of the thesis can be met [TODO: refer back to research questions from Chapter 1], by formulating a model which could inform planners how to minimise drawing from, and returning wastes to, the environment, and thereby improve an area's overall metabolism. Such a model would be high-level (rather than detailed), with its novelty lying in its highly-integrated consideration of energy, water, and waste resource management systems.

In this paper, we formulate an optimisation model which meets demands for energy, water and waste management in such a way that it considers the potential synergies between these sectors, and thereby provide another UM-based tool which can help to improve the metabolism of a city. We proceed by reviewing current modelling approaches within UM and resource optimisation more generally, before formulating the model and demonstrating it on a Chinese urban development.

Before this main aim can be achieved however, there are intermediate aims which must be met. One important piece of work is to propose some way of representing a city as an 'engineered system', for use in the modelling. This question is the subject of Chapter [TODO:]. Another important consideration -- which has been introduced here, but not yet discussed in detail -- is the type of formulation for the model (e.g. linear or nonlinear, and other related considerations). This is dealt with in Chapter [TODO:]. Finally, a question posed by highly integrated urban resource management, is which metrics should be used to measure the efficiency of energy, water and waste systems in combination? This question has not been considered in this chapter, but it is the subject of the next chapter.

### Definition of thesis title

From our review of the literature, it is now possible to precisely define the meaning of the thesis title, in order to define the scope of the thesis:

\begin{description}

\item[Highly integrated] This refers to resource management optimisation models that consider the simultaneous optimisation of more than one system, in order to take advantage of synergies between them (see Section [TODO:]). In this thesis, these will be energy, water, and waste management systems.
\item[Urban] Of the three definitions of 'urban' given in Section [TODO:], this thesis uses the 'geographic-plus' definition. This not only includes processes within a city's administrative boundaries, but also those upstream. Therefore, management infrastructure need only be close to \emph{each other}, because it is this pheneomenon that facilitates intersectoral synergies. I.e., it does not matter if some of the infrastructure is distant from the point of demand for goods and services.
\item[Energy, water, and waste] As mentioned in Section [TODO:], these are the three 'lifeline' services which are common to all users in all cities (residential, commercial, and industrial). This does mean some resource-heavy processes maybe missed out. Such as the manufacturing sector (e.g. demands for iron and steel, process industries etc.). This approach is somewhat arbitrary (and perhaps even limiting -- see Further Work, in Chapter 7), but it helps define the boundaries of the problem, and makes a manageable piece of work for this thesis.
\item[Systems] This incorporates everything required by resource management optimisation models, namely the resources and the processes which form a network.
\end{description}

<!--
As the UM framework is used to study urban sustainability, in relation to its resource flows, forms, and function, one developing area is consider the processes occurring inside a city more closely.
-->

<!--
In summary, optimisation modelling is used for many purposes to help plan resource management. However, our exhaustive search of the literature how shown that no models are appropriate to consider urban energy, water and waste management simultaneously, to realise synergistic benefits. Nevertheless, they do model multiple resource optimisation at suitable scales, to make the idea of such a model plausible (at least from an engineering point of view, if not one of free-market economics.

Lit review structure from JK's MILP paper.

- General decisions (discrete, continuous), linear, nonlienar, algorithms etc.
- Existing models (continue paragraph on small scale)
- Existing models (moving up the scale)
- Existing models (highest level)
- Example of a generic model
- Another example of a generic model
- Another example of a generic model
- Another example of a generic model
- Specific examples
- Summary of existing models
- Models with the most potential
- "The model presented in this paper has been developed to..." continue to understand the inside of the blackbox
-->
